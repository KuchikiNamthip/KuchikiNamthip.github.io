<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Genomics (SNP) | The Whispers of Biology </title> <meta name="author" content="Krittiyabhorn (Namthip) Kongtanawanich"> <meta name="description" content="My genomics (SNP analysis) portfolio"> <meta name="keywords" content="Namthip, Kuchiki Namthip, The Whispers of Biology, omic"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%B8&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kuchikinamthip.github.io/projects/Genome_SNP/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> The Whispers of Biology </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Genomics (SNP)</h1> <p class="post-description">My genomics (SNP analysis) portfolio</p> </header> <article> <h1 id="introduction">Introduction</h1> <p>My passion for disease biology has led me to systematically investigate the multilayered mechanisms of gene regulation. I’ve already established a deep understanding of the regulatory landscape through my prior work:</p> <p>🎨 <em>Epigenomics (ChIP-seq)</em>: Analyzing the dynamic blueprint of the epigenome <a href="https://kuchikinamthip.github.io/projects/Epigenome_ChIP/">(see my Epigenomic portfolio).</a></p> <p>🎨 <em>Transcriptomics</em>: Investigating the functional output of gene expression <a href="https://kuchikinamthip.github.io/projects/Transcriptome/">(see my Transcriptomics portfolio)</a>.</p> <p>However, a fundamental piece of the puzzle has been missing: Genomics. To achieve a truly holistic view—moving beyond how the code is regulated to encompass the primary variations within the code itself—I must delve into the DNA sequence.</p> <p>This portfolio marks my entry into the essential world of genomics, focusing specifically on Single Nucleotide Polymorphism (SNP) analysis. This foundational work is crucial for identifying the genetic variations that drive disease susceptibility.</p> <p>I am extremely fortunate to be mentored in this new domain by <a href="https://www.researchgate.net/profile/Metha-Yaikwawong" rel="external nofollow noopener" target="_blank">Dr. Metha Yaikwawong</a>, a respected expert in SNP analysis. Under his guidance, I am committed to bridging the gap between underlying genetic variation, epigenetic control, and resulting transcriptomic profiles, thereby contributing a complete picture to the field of precision medicine.</p> <hr> <h1 id="overview-of-genome-analysis">Overview of Genome Analysis</h1> <p>Firstly, I would like to clarify that ”genome analysis” ≠ only “variant analysis”, but variant analysis (detecting mutations) is one major branch within it. And SNPs analysis is under variant analysis!</p> <h2 id="1️⃣-what-genome-analysis-actually-includes">1️⃣ What “Genome Analysis” Actually Includes</h2> <p>Genome analysis is a big umbrella — it includes:</p> <table> <thead> <tr> <th style="text-align: left">Category</th> <th style="text-align: left">What it studies</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>Structural / Variant analysis</strong></td> <td style="text-align: left">Detects mutations: SNPs, Indels, CNVs, SVs</td> </tr> <tr> <td style="text-align: left"><strong>Functional analysis</strong></td> <td style="text-align: left">Studies how genes are expressed or regulated (RNA-seq, methylation, etc.)</td> </tr> <tr> <td style="text-align: left"><strong>Comparative / Evolutionary genomics</strong></td> <td style="text-align: left">Compares genomes across individuals or species</td> </tr> <tr> <td style="text-align: left"><strong>Epigenomic analysis</strong></td> <td style="text-align: left">Looks at DNA methylation, histone modification</td> </tr> <tr> <td style="text-align: left"><strong>Metagenomics</strong></td> <td style="text-align: left">Sequences all DNA from an environment or microbiome</td> </tr> </tbody> </table> <h2 id="2️⃣-variant-mutation-analysis--the-core-idea">2️⃣ Variant (Mutation) Analysis — the Core Idea</h2> <p>When people say they “detect mutations” from sequencing data, what they really mean is they find differences between a sample genome and a reference genome. <em>These differences are your “variants” or “mutations”.</em></p> <h3 id="-the-different-between-mutations-and-variants">🧬 The different between “mutations” and “variants”</h3> <table> <thead> <tr> <th style="text-align: left">Term</th> <th style="text-align: left">Simple Definition</th> <th style="text-align: left">Neutral or Value-Judgment?</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>Variant</strong></td> <td style="text-align: left">Any change in DNA sequence compared to a reference genome</td> <td style="text-align: left"> <strong>Neutral</strong> (just a difference)</td> </tr> <tr> <td style="text-align: left"><strong>Mutation</strong></td> <td style="text-align: left">A change in DNA that may <strong>alter biological function</strong> or cause <strong>disease</strong> </td> <td style="text-align: left"> <strong>Value-loaded</strong> (often “bad”)</td> </tr> </tbody> </table> <p>In modern genomics, people mostly use “variant” because not every DNA change is harmful.</p> <h3 id="-terminology-in-practice">🧬 Terminology in Practice</h3> <table> <thead> <tr> <th style="text-align: left">Modern Genomics Term</th> <th style="text-align: left">Older Equivalent</th> <th style="text-align: left">Used in</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>SNV (Single Nucleotide Variant)</strong></td> <td style="text-align: left">SNP or point mutation</td> <td style="text-align: left">Research / sequencing</td> </tr> <tr> <td style="text-align: left"><strong>Pathogenic variant</strong></td> <td style="text-align: left">Disease-causing mutation</td> <td style="text-align: left">Clinical reports</td> </tr> <tr> <td style="text-align: left"><strong>Benign variant</strong></td> <td style="text-align: left">Non-disease variant</td> <td style="text-align: left">Clinical reports</td> </tr> <tr> <td style="text-align: left"><strong>VUS (Variant of Uncertain Significance)</strong></td> <td style="text-align: left">Unknown mutation effect</td> <td style="text-align: left">Genetic testing</td> </tr> </tbody> </table> <h2 id="3️⃣-main-types-of-variants">3️⃣ Main Types of Variants</h2> <table> <thead> <tr> <th style="text-align: left">Variant Type</th> <th style="text-align: left">Description</th> <th style="text-align: left">Example</th> <th style="text-align: center">Size</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>SNP (Single Nucleotide Polymorphism)</strong></td> <td style="text-align: left">One base changes</td> <td style="text-align: left">A → G</td> <td style="text-align: center">1 bp</td> </tr> <tr> <td style="text-align: left"><strong>Indel (Insertion/Deletion)</strong></td> <td style="text-align: left">Few bases added or removed</td> <td style="text-align: left">+AT or -TG</td> <td style="text-align: center">1–50 bp</td> </tr> <tr> <td style="text-align: left"><strong>CNV (Copy Number Variation)</strong></td> <td style="text-align: left">Gene/region duplicated or deleted</td> <td style="text-align: left">2 copies → 1 copy</td> <td style="text-align: center">&gt;1 kb</td> </tr> <tr> <td style="text-align: left"><strong>SV (Structural Variant)</strong></td> <td style="text-align: left">Rearrangements: inversion, translocation, large insertion/deletion</td> <td style="text-align: left">Chromosome breakpoints</td> <td style="text-align: center">&gt;1 kb</td> </tr> <tr> <td style="text-align: left"><strong>Somatic Mutation</strong></td> <td style="text-align: left">Found only in cancer or tissue cells</td> <td style="text-align: left">e.g., KRAS G12D</td> <td style="text-align: center">any size</td> </tr> </tbody> </table> <div class="row justify-content-center"> <div class="col-sm mt-3 mt-md-0 content-center" style="max-width: 100%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/SNP/types_of_variants-480.webp 480w,/assets/img/SNP/types_of_variants-800.webp 800w,/assets/img/SNP/types_of_variants-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/SNP/types_of_variants.png" class="img-fluid rounded z-depth-1 mx-auto" width="100%" height="auto" title="Types of variant" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption text-center"> <a>Image source: https://www.pacb.com/human-genetics-research/ </a> </div> <h3 id="sequencing-strategy-for-variant-calling">🧬Sequencing strategy for variant calling</h3> <div class="row justify-content-center"> <div class="col-sm mt-3 mt-md-0 content-center" style="max-width: 100%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/SNP/variant_seq_table-480.webp 480w,/assets/img/SNP/variant_seq_table-800.webp 800w,/assets/img/SNP/variant_seq_table-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/SNP/variant_seq_table.png" class="img-fluid rounded z-depth-1 mx-auto" width="100%" height="auto" title="Types of variant" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption text-center"> <a>Image source: Koboldt DC, Genome Medicine 2020 </a> </div> <h2 id="4️⃣-variant-calling-workflow">4️⃣ Variant Calling Workflow</h2> <div class="row justify-content-center"> <div class="col-sm mt-3 mt-md-0 content-center" style="max-width: 100%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/SNP/Full_variant%20calling_pipeline-480.webp 480w,/assets/img/SNP/Full_variant%20calling_pipeline-800.webp 800w,/assets/img/SNP/Full_variant%20calling_pipeline-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/SNP/Full_variant%20calling_pipeline.png" class="img-fluid rounded z-depth-1 mx-auto" width="100%" height="auto" title="Types of variant" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <a href="https://hbctraining.github.io/Intro-to-variant-analysis/lessons/00_intro_to_variant_calling.html" target="_blank" rel="external nofollow noopener">Intro-to-variant-analysis by Harvard Chan Bioinformatics Core (HBC)</a> </div> <ol> <li>Sample → DNA Extraction → Sequencing (FASTQ) <br> 🎯Goal: high-quality reads for alignment <br> 🧩Input: paired-end FASTQ files (sample_R1.fastq, sample_R2.fastq) <br> ⚙️Tools: Illumina sequencer, Nanopore, PacBio <br> ↓</li> <li>Quality Control (QC) <br> 🎯Goal: Check read quality, adapter contamination, GC content. <br> ⚙️Tools: Adapter trimming (Trimmomatic, Cutadapt),QC report (FastQC, MultiQC) <br> 🧩Output: cleaned FASTQ files <br> ↓</li> <li>Alignment to Reference Genome (BAM) <br> 🎯Goal:Map reads to a reference genome (e.g., hg38 for human). <br> ⚙️Tools: BWA-MEM, Bowtie2, HISAT2 <br> 🧩Output: SAM → convert to BAM (samtools view -b) <br> ↓</li> <li>Post-processing of BAM (Sorting, Duplicate removal, Recalibration) <br> 🎯Goal: Sort reads, mark PCR duplicates, and perform base quality recalibration. <br> ⚙️Tools: samtools sort, Picard MarkDuplicates, GATK BaseRecalibrator <br> 🧩Output: cleaned and indexed BAM file (sample.bam, sample.bai) <br> ↓</li> <li>SNP Calling (VCF) <br> 🎯Goal: Compare aligned reads to the reference genome → find positions with base changes. <br> ⚙️Tools: GATK HaplotypeCaller, bcftools mpileup + call, FreeBayes <br> 🧩Output: VCF (Variant Call Format) file \ <br> ↓</li> <li>Variant Filtering &amp; Quality Control <br> 🎯Goal: Remove false positives and low-quality SNPs. <br> ⚙️Tools: GATK VariantFiltration, vcftools, bcftools filter <br> 🧩Output: high-confidence VCF 🎯Filtering criteria: <ul> <li>Depth (DP) &gt; 10 \</li> <li>Quality (QUAL) &gt; 30 \</li> <li>Variant allele frequency (VAF) threshold <br> ↓</li> </ul> </li> <li>SNP Annotation (gene, function, dbSNP ID) <br> 🎯Goal: Add biological meaning to each SNP: gene name, transcript, coding effect, dbSNP ID, clinical significance. <br> ⚙️Tools: ANNOVAR, VEP (Variant Effect Predictor), SnpEff <br> 🎯Databases used: <ul> <li>dbSNP (known SNPs) \</li> <li>ClinVar (pathogenicity) \</li> <li>gnomAD (population frequency) \</li> <li>RefSeq / Ensembl gene models <br> ↓</li> </ul> </li> <li>Downstream / Biological Interpretation (depends on purpose) \</li> </ol> <table> <thead> <tr> <th style="text-align: left">Application</th> <th style="text-align: left">Example analysis</th> <th style="text-align: left">Tools</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>Population genomics</strong></td> <td style="text-align: left">PCA, Fst, population structure</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">PLINK</code>, <code class="language-plaintext highlighter-rouge">vcftools</code>, <code class="language-plaintext highlighter-rouge">ADMIXTURE</code> </td> </tr> <tr> <td style="text-align: left"><strong>GWAS</strong></td> <td style="text-align: left">Trait–SNP association</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">PLINK</code>, <code class="language-plaintext highlighter-rouge">GEMMA</code>, <code class="language-plaintext highlighter-rouge">SAIGE</code> </td> </tr> <tr> <td style="text-align: left"><strong>Phylogenetics / evolution</strong></td> <td style="text-align: left">SNP distance, tree</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">IQ-TREE</code>, <code class="language-plaintext highlighter-rouge">SNPhylo</code> </td> </tr> <tr> <td style="text-align: left"><strong>Clinical genomics</strong></td> <td style="text-align: left">Pathogenic variant report</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">ClinVar</code>, <code class="language-plaintext highlighter-rouge">gnomAD</code>, <code class="language-plaintext highlighter-rouge">VarSome</code> </td> </tr> </tbody> </table> <h2 id="5️⃣-conceptual-flow">5️⃣ Conceptual Flow</h2> <h3 id="-unix-core-bioinformatics">🐚 UNIX (core bioinformatics)</h3> <p>FASTQ ──▶ QC ──▶ Alignment ──▶ BAM ──▶ Variant Calling ──▶ VCF</p> <h3 id="-the-different-of-variant-calling-allele-frequency-expectations-germline-vs-somatic">🧬 The different of Variant Calling (Allele Frequency Expectations): Germline vs Somatic</h3> <table> <thead> <tr> <th style="text-align: left">Feature</th> <th style="text-align: left">Germline Variant Calling</th> <th style="text-align: left">Somatic Variant Calling</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">Genome type</td> <td style="text-align: left">Diploid</td> <td style="text-align: left">Mixed tumor subclones</td> </tr> <tr> <td style="text-align: left">Expected # of alleles</td> <td style="text-align: left">≤ 2</td> <td style="text-align: left">Many possible (due to subclones)</td> </tr> <tr> <td style="text-align: left">Typical allele frequency</td> <td style="text-align: left">~0.5 (heterozygous), 1.0 (homozygous)</td> <td style="text-align: left">Variable (0.05–0.9)</td> </tr> <tr> <td style="text-align: left">Major challenge</td> <td style="text-align: left">Simple genotypes</td> <td style="text-align: left">Distinguish real low-frequency variants from noise</td> </tr> <tr> <td style="text-align: left">Tools</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">GATK HaplotypeCaller</code>, <code class="language-plaintext highlighter-rouge">FreeBayes</code> </td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">Mutect2</code>, <code class="language-plaintext highlighter-rouge">VarScan2</code>, <code class="language-plaintext highlighter-rouge">Strelka2</code>, <code class="language-plaintext highlighter-rouge">LoFreq</code> </td> </tr> </tbody> </table> <h3 id="-python-data-science-layer">🐍 Python (data science layer)</h3> <p>VCF ──▶ Filtering ──▶ Summary stats ──▶ Visualization ──▶ Report</p> <hr> <h1 id="-full-snp-analysis-pipeline-with-tool-mapping">🧬 Full SNP Analysis Pipeline with Tool Mapping</h1> <table> <thead> <tr> <th style="text-align: left">Step</th> <th style="text-align: left">Purpose</th> <th style="text-align: left">UNIX / Command Line Tools</th> <th style="text-align: left">Python Libraries / Packages</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>1️⃣ Raw data QC</strong></td> <td style="text-align: left">Check sequencing read quality</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">fastqc</code>, <code class="language-plaintext highlighter-rouge">multiqc</code>, <code class="language-plaintext highlighter-rouge">trimmomatic</code>, <code class="language-plaintext highlighter-rouge">cutadapt</code> </td> <td style="text-align: left">⚪ (rarely in Python) – can wrap tools using <code class="language-plaintext highlighter-rouge">subprocess</code> </td> </tr> <tr> <td style="text-align: left"><strong>2️⃣ Alignment</strong></td> <td style="text-align: left">Map reads to reference genome</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">bwa mem</code>, <code class="language-plaintext highlighter-rouge">bowtie2</code>, <code class="language-plaintext highlighter-rouge">hisat2</code> </td> <td style="text-align: left">⚪ <code class="language-plaintext highlighter-rouge">pysam</code> can read alignment files (BAM/SAM)</td> </tr> <tr> <td style="text-align: left"><strong>3️⃣ SAM → BAM conversion</strong></td> <td style="text-align: left">Compress and sort alignment files</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">samtools view</code>, <code class="language-plaintext highlighter-rouge">samtools sort</code>, <code class="language-plaintext highlighter-rouge">samtools index</code> </td> <td style="text-align: left">✅ <code class="language-plaintext highlighter-rouge">pysam</code> (Python bindings for samtools)</td> </tr> <tr> <td style="text-align: left"><strong>4️⃣ Post-processing</strong></td> <td style="text-align: left">Mark duplicates, base recalibration</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">picard MarkDuplicates</code>, <code class="language-plaintext highlighter-rouge">gatk BaseRecalibrator</code> </td> <td style="text-align: left">⚪ Usually command line (GATK wrapped by Python subprocess if needed)</td> </tr> <tr> <td style="text-align: left"><strong>5️⃣ Variant calling (SNP detection)</strong></td> <td style="text-align: left">Detect SNPs/indels</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">bcftools mpileup + call</code>, <code class="language-plaintext highlighter-rouge">gatk HaplotypeCaller</code>, <code class="language-plaintext highlighter-rouge">freebayes</code> </td> <td style="text-align: left">⚪ Usually done by UNIX (some Python wrappers exist for automation)</td> </tr> <tr> <td style="text-align: left"><strong>6️⃣ Variant filtering</strong></td> <td style="text-align: left">Filter by quality/depth</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">bcftools filter</code>, <code class="language-plaintext highlighter-rouge">vcftools --minQ</code>, <code class="language-plaintext highlighter-rouge">grep</code>, <code class="language-plaintext highlighter-rouge">awk</code> </td> <td style="text-align: left">✅ <code class="language-plaintext highlighter-rouge">pandas</code>, <code class="language-plaintext highlighter-rouge">cyvcf2</code>, <code class="language-plaintext highlighter-rouge">PyVCF</code> (for programmatic filtering)</td> </tr> <tr> <td style="text-align: left"><strong>7️⃣ Variant statistics</strong></td> <td style="text-align: left">Ts/Tv ratio, allele frequency</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">vcftools --TsTv-summary</code>, <code class="language-plaintext highlighter-rouge">bcftools stats</code> </td> <td style="text-align: left">✅ <code class="language-plaintext highlighter-rouge">scikit-allel</code>, <code class="language-plaintext highlighter-rouge">pandas</code> </td> </tr> <tr> <td style="text-align: left"><strong>8️⃣ Variant annotation</strong></td> <td style="text-align: left">Add gene, effect, dbSNP ID</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">VEP</code>, <code class="language-plaintext highlighter-rouge">ANNOVAR</code>, <code class="language-plaintext highlighter-rouge">SnpEff</code> </td> <td style="text-align: left">⚪ Can parse output in Python for summary</td> </tr> <tr> <td style="text-align: left"><strong>9️⃣ Data visualization</strong></td> <td style="text-align: left">Plot SNP density, allele frequency</td> <td style="text-align: left">—</td> <td style="text-align: left">✅ <code class="language-plaintext highlighter-rouge">matplotlib</code>, <code class="language-plaintext highlighter-rouge">seaborn</code>, <code class="language-plaintext highlighter-rouge">plotly</code>, <code class="language-plaintext highlighter-rouge">scikit-allel</code> </td> </tr> <tr> <td style="text-align: left"><strong>🔟 Population analysis (optional)</strong></td> <td style="text-align: left">PCA, diversity, Fst, GWAS</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">plink</code>, <code class="language-plaintext highlighter-rouge">vcftools</code>, <code class="language-plaintext highlighter-rouge">ADMIXTURE</code> </td> <td style="text-align: left">✅ <code class="language-plaintext highlighter-rouge">scikit-allel</code>, <code class="language-plaintext highlighter-rouge">numpy</code>, <code class="language-plaintext highlighter-rouge">scipy</code>, <code class="language-plaintext highlighter-rouge">pandas</code> </td> </tr> <tr> <td style="text-align: left"><strong>1️⃣1️⃣ Reporting</strong></td> <td style="text-align: left">Summarize and export tables</td> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">awk</code>, <code class="language-plaintext highlighter-rouge">sed</code>, <code class="language-plaintext highlighter-rouge">grep</code>, <code class="language-plaintext highlighter-rouge">Rscript</code> </td> <td style="text-align: left">✅ <code class="language-plaintext highlighter-rouge">pandas</code>, <code class="language-plaintext highlighter-rouge">xlsxwriter</code>, <code class="language-plaintext highlighter-rouge">csv</code>, <code class="language-plaintext highlighter-rouge">matplotlib</code> </td> </tr> </tbody> </table> <h2 id="note">NOTE</h2> <p>There are so many details about the analysis such as</p> <ul> <li>Germline and somatic variant calling is different, thus tools and setting are different.</li> </ul> <hr> <h1 id="my-snps-analysis">My SNPs analysis</h1> <p>I will start with a VCF files which were finished upstream process.</p> <p><strong>✅ Good sources of public VCF files</strong> Sure! Here’s the same style of writing for <strong>ClinVar and other commonly used public VCF sources</strong> 👇</p> <hr> <p><strong>✅ Good sources of public VCF files</strong></p> <ol> <li> <a href="https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/" rel="external nofollow noopener" target="_blank">ClinVar (NCBI)</a> – Provides curated <strong>variant calls with clinical significance</strong> (e.g., pathogenic, benign, uncertain significance) for the human genome (GRCh37 &amp; GRCh38). ftp.ncbi.nlm.nih.gov</li> <li> <a href="https://gnomad.broadinstitute.org/downloads" rel="external nofollow noopener" target="_blank">gnomAD (Genome Aggregation Database)</a> – Contains <strong>population-level allele frequencies</strong> for millions of variants across exomes and genomes from diverse human -cohorts. gnomad.broadinstitute.org</li> <li> <a href="https://gnomad.broadinstitute.org/downloads#exac-legacy" rel="external nofollow noopener" target="_blank">ExAC (Exome Aggregation Consortium)</a> – The predecessor to gnomAD, focused on <strong>exome sequencing data</strong> from over 60,000 unrelated individuals. gnomad.broadinstitute.org</li> <li> <a href="https://www.internationalgenome.org/category/vcf" rel="external nofollow noopener" target="_blank">1000 Genomes Project / IGSR</a> – Hosts <strong>genome-wide variant data</strong> (phase 3) across multiple populations, often used as a standard reference dataset. internationalgenome.org</li> <li> <a href="https://my.pgp-hms.org/public_genetic_data?data_type=other&amp;utf8=%E2%9C%93&amp;utm" rel="external nofollow noopener" target="_blank">Personal Genome Project (PGP)</a> – Contains <strong>public genomes of volunteer participants</strong> with available VCFs (exome and whole-genome). my.pgp-hms.org</li> </ol> <p><strong>✅ Database as reference catalogue (not provide individual information)</strong></p> <ul> <li> <a href="https://ftp.ncbi.nlm.nih.gov/snp/latest_release/VCF/" rel="external nofollow noopener" target="_blank">dbSNP (NCBI)</a> – A comprehensive catalog of <strong>all known single nucleotide polymorphisms (SNPs)</strong> and short indels reported across studies, organized by chromosome.</li> </ul> <hr> <h2 id="1-data-set-1-1000-genome">1. Data set 1: 1000 Genome</h2> <p>I will download it from <a href="https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/ALL.chr1.phase3_shapeit2_mvncall_integrated_v5b.20130502.genotypes.vcf.gz" rel="external nofollow noopener" target="_blank">1000 Genome</a></p> <h3 id="steps">Steps</h3> <ol> <li>Download file from public resource and cut it to small file for demonstration.</li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># download</span>
<span class="nb">cd</span> /home/kk/Jupyter_docker/SNP_interview/input/1000genome
wget https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/ALL.chr1.phase3_shapeit2_mvncall_integrated_v5b.20130502.genotypes.vcf.gz

<span class="c"># get only first 500 lines</span>
zcat ALL.chr1.phase3_shapeit2_mvncall_integrated_v5b.20130502.genotypes.vcf.gz | <span class="nb">grep</span> <span class="s1">'^#'</span> <span class="o">&gt;</span> 1000genome_test.vcf
zcat ALL.chr1.phase3_shapeit2_mvncall_integrated_v5b.20130502.genotypes.vcf.gz | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'^#'</span> | <span class="nb">head</span> <span class="nt">-n</span> 500 <span class="o">&gt;&gt;</span> 1000genome_test.vcf

<span class="c"># compress to .gz again</span>
bgzip 1000genome_test.vcf
tabix <span class="nt">-p</span> vcf 1000genome_test.vcf.gz

<span class="c"># change to .tsv</span>
zcat 1000genome_test.vcf.gz | <span class="nb">grep</span> <span class="s1">'^#CHROM'</span> | <span class="nb">sed</span> <span class="s1">'s/^#//'</span> <span class="o">&gt;</span> 1000genome_test.tsv
zcat 1000genome_test.vcf.gz | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'^#'</span> | <span class="nb">head</span> <span class="nt">-n</span> 500 <span class="o">&gt;&gt;</span> 1000genome_test.tsv
</code></pre></div></div> <ol> <li>Inspect the fil: What’s inside a 1000G VCF</li> </ol> <p>Each row (variant record) summarizes one position in the genome and how it varies across individuals.</p> <p><strong>🧠 Columns (core meaning)</strong></p> <table> <thead> <tr> <th>Column</th> <th>Example</th> <th>Meaning</th> <th> </th> <th> </th> </tr> </thead> <tbody> <tr> <td><strong>CHROM</strong></td> <td>1</td> <td>Chromosome number</td> <td> </td> <td> </td> </tr> <tr> <td><strong>POS</strong></td> <td>10506</td> <td>Position (1-based) on that chromosome</td> <td> </td> <td> </td> </tr> <tr> <td><strong>ID</strong></td> <td>rs12345</td> <td>Variant ID (dbSNP rsID)</td> <td> </td> <td> </td> </tr> <tr> <td><strong>REF</strong></td> <td>T</td> <td>Reference allele from reference genome</td> <td> </td> <td> </td> </tr> <tr> <td><strong>ALT</strong></td> <td>A</td> <td>Alternate allele (observed variant)</td> <td> </td> <td> </td> </tr> <tr> <td><strong>QUAL</strong></td> <td>100</td> <td>Variant quality score (Phred-scaled likelihood)</td> <td> </td> <td> </td> </tr> <tr> <td><strong>FILTER</strong></td> <td>PASS</td> <td>Whether the variant passed QC filters</td> <td> </td> <td> </td> </tr> <tr> <td><strong>INFO</strong></td> <td>AC=5;AF=0.001;AN=5008;NS=2504;DP=8000</td> <td> <strong>Summary stats</strong> for that variant</td> <td> </td> <td> </td> </tr> <tr> <td><strong>FORMAT</strong></td> <td>GT:DP</td> <td>Structure of genotype fields in each sample column</td> <td> </td> <td> </td> </tr> <tr> <td><strong>HG00096, HG00097, …</strong></td> <td>0</td> <td>1, 0</td> <td>0</td> <td>Each person’s <strong>genotype</strong> (reference/alternate alleles)</td> </tr> </tbody> </table> <p><strong>🧠 How to read the INFO field</strong></p> <p>Here’s what the 1000 Genomes INFO tags mean (Phase 3 standard):</p> <table> <thead> <tr> <th>INFO key</th> <th>Meaning</th> <th>Example</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><strong>AC</strong></td> <td> <em>Allele Count</em> (number of ALT alleles across all samples)</td> <td><code class="language-plaintext highlighter-rouge">AC=5</code></td> <td>5 alternate alleles observed out of all chromosomes sequenced</td> </tr> <tr> <td><strong>AN</strong></td> <td> <em>Allele Number</em> (total chromosomes observed)</td> <td><code class="language-plaintext highlighter-rouge">AN=5008</code></td> <td>For 2504 diploid individuals, total alleles = 2×2504 = 5008</td> </tr> <tr> <td><strong>AF</strong></td> <td><em>Allele Frequency</em></td> <td><code class="language-plaintext highlighter-rouge">AF=0.001</code></td> <td>Frequency = AC/AN = 0.001 → 0.1%</td> </tr> <tr> <td><strong>NS</strong></td> <td><em>Number of Samples with Data</em></td> <td><code class="language-plaintext highlighter-rouge">NS=2504</code></td> <td>All samples were genotyped at this site</td> </tr> <tr> <td><strong>DP</strong></td> <td> <em>Total Depth</em> (sum of read depth across all samples)</td> <td><code class="language-plaintext highlighter-rouge">DP=78015</code></td> <td>Combined coverage</td> </tr> <tr> <td><strong>EAS_AF, EUR_AF, AFR_AF, AMR_AF, SAS_AF</strong></td> <td><em>Per-population allele frequencies</em></td> <td><code class="language-plaintext highlighter-rouge">EAS_AF=0.0002</code></td> <td>Subpopulation allele frequency</td> </tr> <tr> <td><strong>VT</strong></td> <td><em>Variant Type</em></td> <td><code class="language-plaintext highlighter-rouge">VT=SNP</code></td> <td>Indicates type: SNP, INDEL, etc.</td> </tr> <tr> <td><strong>AA</strong></td> <td><em>Ancestral Allele</em></td> <td><code class="language-plaintext highlighter-rouge">AA=T</code></td> <td>Original allele in ancestral genome</td> </tr> <tr> <td><strong>RS</strong></td> <td> <em>dbSNP rsID</em> (redundant with ID field sometimes)</td> <td><code class="language-plaintext highlighter-rouge">RS=12345</code></td> <td>dbSNP ID</td> </tr> <tr> <td><strong>MQ</strong></td> <td><em>Mapping Quality</em></td> <td><code class="language-plaintext highlighter-rouge">MQ=60</code></td> <td>Average mapping quality of reads supporting the call</td> </tr> <tr> <td><strong>QD</strong></td> <td><em>Quality by Depth</em></td> <td><code class="language-plaintext highlighter-rouge">QD=15</code></td> <td>Normalized quality</td> </tr> <tr> <td><strong>VQSLOD</strong></td> <td><em>Variant Quality Score Log-Odds</em></td> <td><code class="language-plaintext highlighter-rouge">VQSLOD=2.5</code></td> <td>Used in recalibration (GATK)</td> </tr> </tbody> </table> <p><strong>🧭 Quick biological interpretation of common INFOs</strong></p> <table> <thead> <tr> <th>INFO tag</th> <th>Low value means</th> <th>High value means</th> <th>Clinical relevance</th> </tr> </thead> <tbody> <tr> <td><strong>AF</strong></td> <td>Rare variant</td> <td>Common polymorphism</td> <td>Rare = possibly pathogenic (if in ClinVar)</td> </tr> <tr> <td><strong>QUAL</strong></td> <td>Unreliable call</td> <td>Confident call</td> <td>Filter threshold often &gt;30</td> </tr> <tr> <td><strong>DP</strong></td> <td>Low sequencing coverage</td> <td>High coverage</td> <td>Low DP variants may be false</td> </tr> <tr> <td><strong>FILTER</strong></td> <td>Failed QC</td> <td>Passed QC</td> <td>Use only <code class="language-plaintext highlighter-rouge">PASS</code> </td> </tr> <tr> <td><strong>AC</strong></td> <td>Found in few alleles</td> <td>Found in many alleles</td> <td>Helps compute frequency</td> </tr> <tr> <td><strong>AN</strong></td> <td>Poor coverage (missing genotypes)</td> <td>All samples genotyped</td> <td>Important for accuracy</td> </tr> </tbody> </table> <h3 id="filtering-by-python">Filtering by Python</h3> <ol> <li>Keep PASS variants only</li> <li>Keep SNPs (not INDELs → VT=SNP)</li> <li>Keep biallelic sites (len(ALT.split(‘,’)) == 1)</li> <li>Apply QC filters (QUAL, DP, etc.)</li> <li>Remove common variants if searching for rare disease-causing ones (AF &lt; 0.01)</li> <li>Keep variants in coding or regulatory regions</li> <li>Annotate with ClinVar, dbNSFP, or custom database</li> <li>Filtering according to annotation meaning.</li> </ol> <p>Here is <a href="https://kuchikinamthip.github.io/ComBio_Portfolio/SNP/Data1_1000Genome/1000genome_VCF_tsv_filtering.html">my Jupyter notebook</a> from filtering process 1 to 6.</p> <h3 id="what-i-have-learned-from-this-data-set">What I have learned from this data set</h3> <p>This is SNP analysis for an individual person. The key filtering process is rare disease-causing ones (AF &lt; 0.01). Therefore many SNPs still in the panel. We next have to filter by the annotation such as ClinVar. ClinVar will identify whether the SNP are pathogenic, benign, and uncertain significance. Other annotations are also identify diffedrent meaningful SNP such as exon, intron, framship, missense, etc.</p> <hr> <h2 id="other-types-of-snp-analysis">Other types of SNP analysis</h2> <h3 id="compare-case-disease-and-control-healthy">Compare case (Disease) and control (healthy)</h3> <p>The process:</p> <ol> <li>Get .VCF from both case and control</li> <li>Put the processed data to <code class="language-plaintext highlighter-rouge">PLINK</code> to identify the SNP that different between case and control.</li> <li>The final analysis result is 2 by 2 table.</li> </ol> <h3 id="-statistical-analysis-in-snp-studies">🧬 Statistical Analysis in SNP Studies</h3> <p>In SNP (Single Nucleotide Polymorphism) analysis, categorical comparison between groups (e.g., case vs. control) is a key component of statistical testing.</p> <ol> <li>Comparison Tests <ul> <li> <p>Chi-square test — used for categorical data with sufficient expected counts.</p> </li> <li> <p>Fisher’s exact test — applied when any cell in a 2×2 contingency table has an expected count &lt; 5.</p> </li> </ul> </li> </ol> <p>These tests evaluate the association between genotype (or allele) and phenotype using p-values to determine statistical significance.</p> <ol> <li> <p>Predictive Modeling</p> <ul> <li>Logistic regression — used to assess the association between SNPs and binary outcomes (e.g., disease vs. healthy), adjusting for potential covariates such as age, sex, or population stratification.</li> </ul> </li> <li> <p>Effect Size Estimation</p> <ul> <li>Report odds ratio (OR) and 95% confidence interval (CI) to quantify the strength and direction of the association between the SNP and the trait of interest.</li> </ul> </li> </ol> <hr> <h2 id="useful-resources">Useful resources</h2> <ul> <li> <a href="https://cloufield.github.io/GWASTutorial/" rel="external nofollow noopener" target="_blank">GWASTutorial</a> by The Laboratory of Complex Trait Genomics at the University of Tokyo</li> <li> <a href="https://github.com/MareesAT/GWA_tutorial" rel="external nofollow noopener" target="_blank">GWA analysis</a> by Andries Marees</li> </ul> <hr> <h2 id="acknowledgment">Acknowledgment</h2> <ul> <li>I would like to acknowledge <a href="https://www.researchgate.net/profile/Metha-Yaikwawong" rel="external nofollow noopener" target="_blank">Dr. Metha Yaikwawong</a> for his encouragement and the valuable knowledge he provided on the earlier days of my programming journey.</li> </ul> <hr> <p>I’m very happy 🥰 that you are visiting my computational biology portfolio and would be even happier if you could provide suggestions or feedback 🤩.</p> <p>You can contact me through various online platforms <a href="https://kuchikinamthip.github.io/">here 📬</a> or leave a comment below using GitHub account. 👇🏼</p> </article> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'KuchikiNamthip/KuchikiNamthip.github.io',
        'data-repo-id': 'R_kgDOMFy1BA',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Krittiyabhorn (Namthip) Kongtanawanich. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script defer src="/assets/js/google-analytics-setup.js?12374742c4b1801ba82226e617af7e2d"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>